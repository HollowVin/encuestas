---
title: "CEPRA-RES - Encuesta escuelas CUENCA e IBARRA"
author: "Universidas de Cuenca, Universidad del Azuay, Pontificia Universidad Católica del Ecuador Sede Ibarra"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_height: 4
    fig_width: 6
    highlight: tango
    theme: united
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: yes
      smooth_scroll: no
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE,cache=TRUE,
               cache.path = 'Encuentas_Marzo2020/CUENCA/')
```

```{r knitr_init}
# Knit options in order to compile a html output
suppressMessages(library(knitr))

## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               cache.path = 'Encuentas_Marzo2020/CUENCA/',
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=75)
```


# Cepra.RES. Cuenca e Ibarra

**Proyecto**

Evaluación de entornos urbanos peatonales para la identificación de rutas escolares seguras en ciudades intermedias del Ecuador, 2020.</br>

**Financiadores**

Corporación Ecuatoriana para el Desarrollo de la Investigación y la Academia (CEDIA) </br>
Universidad de Cuenca </br>
Universidad del Azuay </br>
Pontificia Universidad Católica del Ecuador Sede Ibarra</br>

**Investigadores**

Universidad de Cuenca</br>
Daniel Augusto Orellana Vintimilla `daniel.orellana@ucuenca.edu.ec`</br>
Adriana Eulalia Quezada Larriva `adriana.quezada@ucuenca.edu.ec`</br>
Andrea Daniela Cobo Torres  `daniela.cobot@ucuenca.edu.ec`</br>
Javier Andrés García Galarza  `jgarcia@ubicacuenca.com` </br>
Joseline Gabriela Carrión Astudillo `gabriela.carrion@ucuenca.edu.ec`</br>
Camila Mariana Pérez Calle  `camila.perez@ucuenca.edu.ec`</br></br>

Universidad del Azuay</br>
Carla Marcela Hermida Palacios  `chermida@uazuay.edu.ec`</br>
Daniela Elisabet Ballari `dballari@uazuay.edu.ec`</br>
Gabriela Lituma `mlitumapau@es.uazuay.edu.ec` </br>
Jaime Andrés Peña Rosas `jmepr@es.uazuay.edu.ec`</br>
Francisco David Salgado Castillo  `fdsalgado@uazuay.edu.ec`</br></br>

Pontificia Universidad Católica del Ecuador Sede Ibarra</br>

Jorge Javier Andrade Benítez  `jjandrade@pucesi.edu.ec`</br>
Mónica Gabriela Naranjo Serrano  `mgnaranjo@puce.edu.ec`</br>
María José Valdospinos Carvajal `mariajosevaldospinos@gmail.com` </br>
Iveth Alejandra Ortega Pérez;  Pontificia Universidad Católica del Ecuador Sede Ibarra; `ivethortega2016@gmail.com` </br>
Alvaro Sebastián Galarza Bastidas `asgalarza1@pucesi.edu.ec`</br>

**Descripción de instrumento cuantitativo a padres**

Encuesta a padre/madre o representante legal: La encuesta se aplicó al grupo de padres o madres o representantes legales de niños(as) de 7mo año de educación básica (entre 10 y 12 años) de las escuelas seleccionadas para los casos de estudio. Previamente a la aplicación se realizará una explicación del proyecto y se solicitará el consentimiento informado. Para la selección y diseño del instrumento se realizó una revisión de literatura en la que se identificaron las variables relacionadas con la movilidad activa de niños - de 9 a 12 años- a la escuela y la influencia de los padres en el modo de transporte de los niños. Como resultado se identificó el Cuestionario de familias del proyecto Pedalea y Anda al COle (PACO) el cual fue adaptado, ajustado y validado para las ciudades de Cuenca e Ibarra (Ecuador). Se realizó una validación transcultural, la revisión de temas y preguntas por un grupo de expertos, y el desarrollo de pruebas piloto.  La experticia de los revisores se enfoca en el estudio del entorno construido, la movilidad activa y psicología infantil. La revisión de expertos contribuyó en: i) identificar la pertinencia de los temas y las variables que incluye el cuestionario, ii) identificar los temas y variables que se considere relevante incluir para el contexto del estudio, y iii) estructurar las preguntas y definir contenidos que garanticen que la guía aplicada sea adecuada para los participantes. Una vez realizados los ajustes recomendados por los expertos, el cuestionario guía se aplicó a padres de familia que no formarán parte del estudio con el propósito de determinar la claridad del instrumento y realizar los ajustes finales a la encuesta que finalmente fue revisada nuevamente por el grupo de expertos.

**Fecha de aplicación del instrumento**

Febrero/Marzo 2020

**Escuelas participantes**

Cuenca

- Luis Cordero </br>
- Nicolas Sojos </br>
- Isabel Moscoso </br>

Ibarra

- Agustin Cueva </br>
- Ana Luisa Leoro </br>
- Velasco Ibarra </br>


```{r echo=FALSE, warning=FALSE}
#libraries
suppressMessages(library(readxl))
suppressMessages(library(ggplot2))
suppressMessages(library(dplyr))
suppressMessages(library(plotly))
suppressMessages(library(vcd))

```

```{r echo=FALSE , warning=FALSE}
#Graficos barras x ciudad
graficos<- function(colnumber.c,colnumbar.i,facetcolum.c, facetcolumn.i, levels, angle, ylim){

  datos.tmp.c<- datos[,c(colnumber.c, facetcolum.c)]
  names(datos.tmp.c)<- c("clase", "ciudad")
datos.tmp.i<- datos.i[,c(colnumbar.i, facetcolumn.i)]
  names(datos.tmp.i)<- c("clase", "ciudad")

datos.tmp<- rbind(datos.tmp.c, datos.tmp.i)

datos.tmp$clase[is.na(datos.tmp$clase)]<-"No sabe/No contesta"

datos.tmp$clase<- factor(datos.tmp$clase, levels=levels,ordered=TRUE)


datos.tmp.2 <-datos.tmp %>% dplyr::group_by(ciudad,clase)%>%  
    na.omit() %>% dplyr::summarise(n = dplyr::n())%>%
  dplyr::mutate(Frecuencia = round(100*n / sum(n),2))

# datos.tmp.2$clase<- factor(datos.tmp.2$clase, levels=levels,ordered=TRUE)

# print(sum(datos.tmp.2$Frecuencia))

p<- ggplot(datos.tmp.2, aes(x=clase, y=Frecuencia, fill=factor(ciudad)))+ geom_bar(stat="identity",position="dodge")+ theme(axis.text.x = element_text(angle = angle)) +labs(x="", y="%") + scale_fill_manual(values=c("dodgerblue2","darkorange1"))+
  guides(fill=guide_legend(title=""))+facet_grid(.~ciudad)

return(list(datos.tmp,p))
}

mosaic.a<- function(plot){
SD<- structable(clase ~ ciudad, data = plot[[1]])
mosaic(SD, shade = TRUE,
         labeling = labeling_values,#,labeling_residuals
         labeling_args = list(abbreviate_labs = 9,
                              gp_labels = gpar(fontsize = 8),
                              varnames=c(FALSE,FALSE),
                              rot_labels=c(90,0,0,0),
                              just_labels = c("left", "right")))
}

mosaic.a<- function(plot){
SD<- structable(clase ~ ciudad, data = plot[[1]])
mosaic(SD, shade = TRUE,
         labeling = labeling_values,#,labeling_residuals
       split_vertical = c(TRUE, FALSE),
        spacing = spacing_dimequal(c(0.3,0.3)),
         labeling_args = list(abbreviate_labs = 12,
                              gp_labels = gpar(fontsize = 8),
                              varnames=c(FALSE,FALSE),
                              rot_labels=c(0,0,90,0),
                              just_labels = c("left", "right")))
}
```

```{r}
#Load data
datos <- read_excel("RESULTADOS ENCUESTA A PADRES.xlsx")

datos$escuela<- NA
datos$escuela[grepl("LC", datos$`Datos encuesta/Código de la encuesta`)]<-"C.LC"
datos$escuela[grepl("NS", datos$`Datos encuesta/Código de la encuesta`)]<-"C.NS"
datos$escuela[grepl("IM", datos$`Datos encuesta/Código de la encuesta`)]<-"C.IM"
datos<- datos[!is.na(datos$escuela),]#Se selecciona únicamente los datos de cuenca
datos$ciudad<-"Cuenca"

# which(names(datos)=="ciudad")
# which(names(datos.i)=="ciudad")

datos.i <- read_excel("DATOS ENCUESTAS IBARRA.xlsx")
datos.i$escuela[datos.i$escuela=="Agustín Cueva"]<-"I.AC"
datos.i$escuela[datos.i$escuela=="Ana Luisa Leoro"]<-"I.ALL"
datos.i$escuela[datos.i$escuela=="Velasco Ibarra"]<-"I.VI"
datos.i$ciudad<-"Ibarra"

# export 
# write.csv(datos,"datosCuenca.csv")

# names(datos)
# 
# names(datos.i)
```

# A. Analisis Global

## 1. Datos Encuestado {.tabset .tabset-fade .tabset-pills}

### Edad {.tabset .tabset-fade}

#### Encuestado

```{r echo=FALSE, warning=FALSE, message=FALSE}
# datos$"Datos encuestado/3.1. Edad"[datos$"Datos encuestado/3.1. Edad"== "-"]<- NA
edad.c<-data.frame(as.numeric(datos$"Datos encuestado/3.1. Edad"), datos$escuela, datos$ciudad)
names(edad.c)<- c("edad", "escuela", "ciudad")

edad.i<-data.frame(as.numeric(datos.i$"3.1. Edad"), datos.i$escuela, datos.i$ciudad)
names(edad.i)<- c("edad", "escuela", "ciudad")

edad<- rbind(edad.c, edad.i)
ggplotly(ggplot(edad)+ geom_histogram(aes(x=edad, y=stat(count), fill=factor(ciudad)))+ theme(axis.text.x = element_text(angle = 0),legend.position = "none") +labs(x="", y="Frecuencia") + scale_fill_manual(values=c("dodgerblue2","darkorange1"))+
  guides(fill=guide_legend(title=""))+facet_grid(.~ciudad))
```

#### Hijo/a o representado

```{r echo=FALSE, warning=FALSE, message=FALSE}
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "-"]<- NA
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "NC"]<- NA

edad.h.c<-data.frame(as.numeric(datos$"Datos encuestado/3.2. Edad de su hijo/a o representado"[!is.na(datos$"Datos encuestado/3.2. Edad de su hijo/a o representado")]), datos$escuela, datos$ciudad)
names(edad.h.c)<- c("edad", "escuela", "ciudad")
edad.h.c$edad[edad.h.c$edad == "1"]<- NA

edad.h.i<-data.frame(as.numeric(datos.i$"3.2. Edad de su hijo/a o representado"), datos.i$escuela, datos.i$ciudad)
names(edad.h.i)<- c("edad", "escuela", "ciudad")

edad.h<- rbind(edad.h.c, edad.h.i)
# table(edad.h$edad,edad.h$ciudad)
ggplotly(ggplot(edad.h)+ geom_histogram(aes(x=edad, y=stat(count), fill=factor(ciudad)),binwidth=1)+ theme(axis.text.x = element_text(angle = 0),legend.position = "none") +labs(x="", y="Frecuencia") + scale_fill_manual(values=c("dodgerblue2","darkorange1"))+
  guides(fill=guide_legend(title=""))+facet_grid(.~ciudad))
```

### Parentezco  
Pregunta: `r names(datos[,8])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(8, 8,139,265,c("Madre", "Padre", "Otro", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Genero niño/a  
Pregunta: `r names(datos[,10])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(10, 10,139,265,c("Niña", "Niño", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

## 2. Modo desplazamiento casa-escuela {.tabset .tabset-fade .tabset-pills}

### Desplazamiento 
Pregunta: `r names(datos[,14])`

```{r echo=FALSE, warning=FALSE}
# unique(datos[,14])
# unique(datos.i[,14])

plot<- graficos(14, 14,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

`Interpretación del mosaico: Tamaño de cuadros es proporcional al número de registros.Los cuadros coloreados en azúl significa que contienen mas registros que los esperados bajo la hipótesis nula de independencia. Los cuadros en rojo significa que ha habido menos registro que los esperados. Es decir, los cuadros coloredos muestran asociaciones o dependiencias (positivas o negativas) entre las categorías.`  

`En este caso, las categorías Caminando, Buseta Escolar, Bus Escolar y Bus Público, son dependientes de la ciudad de Cuenca e Ibarra.Es decir, para Cuenca, se observa una asociación positiva entre as categorias Caminando y Buseta Escolar y negataiva con bus público. Mientras que para Ibarra, se observa una asociación postiva con Bus Público y negativa con Caminando.`

### ¿Camina la última parte del trayecto?
Pregunta: `r names(datos[,16])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(16, 16,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

`Para Cuenca, se observa una asociación negavita en la categoría Si camina.`

### ¿Va solo/a a la escuela?
Pregunta: `r names(datos[,18])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(18, 18,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

`Para Cuenca, se observa una asociación negativa en la categoría Si va solo a la escuela. Mientras que para Ibarra, se observa una asociación postiva con Si va solo a la escuela.`


### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,19])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(19, 19,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,20])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(20, 20,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,21])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(21,21,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Abuelo
Pregunta: `r names(datos[,22])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(22,22,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```


#### Otros niños/adolescentes
Pregunta: `r names(datos[,23])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(23,23,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,24])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(24,24,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,25])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(25,25,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```


## 3. Modo desplazamiento escuela-casa {.tabset .tabset-fade .tabset-pills}

### Desplazamiento
Pregunta: `r names(datos[,26])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(26,26,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

`Para Cuenca, se observa una asociación postiva en las categorías Caminando y Buseta Escolar, y negativa en Bus Público. Mientras que para Ibarra, se observa una asociación positiva con Bus Público, y negativa con Caminando.`

### ¿Camina la primera parte del trayecto?
Pregunta: `r names(datos[,28])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(28,28,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

`Para Cuenca, se observa una asociación negativa en la categoría Si Camina.`

### ¿Regresa solo/a?
Pregunta: `r names(datos[,30])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(30,30,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,31])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(31,31,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,32])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(32,32,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,33])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(33,33,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

####  Abuelo
Pregunta: `r names(datos[,34])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(34,34,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Otros niños/adolescentes
Pregunta: `r names(datos[,35])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(35,35,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,36])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(36,36,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,37])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(37,37,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

## 4. Percepción y razones {.tabset .tabset-fade .tabset-pills}


<!-- `Interpretación. En relación a la perpeción de los padres respecto del modo de transporte, se observó independencia de las diferetnes preguntas para las Ciudades de Cuenca e Ibarra` -->

### Miedo a ir solo/a

Pregunta: `r names(datos[,38])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(38,38,139,265,c("Si tengo miedo", "No tengo miedo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Razones {.tabset .tabset-fade}

¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? ¿Qué tanta incidencia tienen los siguientes factores?

#### Distancia
Pregunta: `r names(datos[,40])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(40,40,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Seguridad Vial
Pregunta: `r names(datos[,41])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(41,41,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Seguridad Personal
Pregunta: `r names(datos[,42])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(42,42,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Relaciones Sociales
Pregunta: `r names(datos[,43])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(43,43,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Costo
Pregunta: `r names(datos[,44])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(44,44,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Salud
Pregunta: `r names(datos[,45])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(45,45,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```


#### Conveniencia
Pregunta: `r names(datos[,46])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(46,46,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

## 5. Detalles del desplazamiento {.tabset .tabset-fade .tabset-pills}

<!-- `Interpretación. En relación con los detalles del desplazamiento, se observó independencia de las diferentes preguntas para las Ciudades de Cuenca e Ibarra` -->

### Tiempo de desplazamiento 
Pregunta: `r names(datos[,48])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(48,48,139,265,c("Menos de 5 min", "Entre 5 min y 15 min", "Entre 15 min y 30 min", "Entre 30 min y 60 min", "Más de 60 min", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```


### Distancia aceptable  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,49])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(49,49,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,50])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(50,50,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```


#### Con adultos
Pregunta: `r names(datos[,51])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(51,51,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Distancia aceptable en bicicleta  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(52,52,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(53,53,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,54])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(54,54,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Caminar a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,55])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(55,55,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,56])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(56,56,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,57])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(57,57,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Ir en bicileta a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,58])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(58,58,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,59])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(59,59,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,60])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(60,60,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

## 6. Preocupación en caminar y bicicleta {.tabset .tabset-fade .tabset-pills}

¿Qué tanto le preocuparían estas situaciones con respecto a que su hijo camine o vaya en bicicleta a la escuela?

<!-- `Interpretación. En relación con elementos de preocupación en caminar y bicicleta, se observó independencia de las diferentes preguntas para las Ciudades de Cuenca e Ibarra` -->

### Situaciones Generales  {.tabset .tabset-fade}

#### Distancia
Pregunta: `r names(datos[,62])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(62,62,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,63])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(63,63,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```


#### Velocidad automóviles
Pregunta: `r names(datos[,64])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(64,64,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Tiempo
Pregunta: `r names(datos[,65])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(65,65,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Seguridad intersecciones
Pregunta: `r names(datos[,66])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(66,66,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Presencia de polícias
Pregunta: `r names(datos[,67])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(67,67,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,68])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(68,68,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Frio/calor
Pregunta: `r names(datos[,69])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(69,69,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Lluvia
Pregunta: `r names(datos[,70])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(70,70,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Peso mochila
Pregunta: `r names(datos[,71])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(71,71,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Sobre caminar  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,72])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(72,72,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Veredas mal estado
Pregunta: `r names(datos[,73])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(73,73,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,74])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(74,74,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,75])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(75,75,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Sobre biclicleta  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,76])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(76,76,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Ausencia de ciclovias
Pregunta: `r names(datos[,77])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(77,77,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Espacio para bicicleta
Pregunta: `r names(datos[,78])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(78,78,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,79])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(79,79,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,80])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(80,80,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Mejora de situaciones al caminar o bicicleta {.tabset .tabset-fade}

Si las siguientes situaciones mejoran ¿dejaría a su hijo/a ir caminando o en bicicleta a la escuela?

#### Distancia
Pregunta: `r names(datos[,82])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(82,82,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,83])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(83,83,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Intersecciones
Pregunta: `r names(datos[,84])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(84,84,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,85])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(85,85,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Cantidad de personas
Pregunta: `r names(datos[,86])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(86,86,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Veredas
Pregunta: `r names(datos[,87])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(87,87,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Ciclovias
Pregunta: `r names(datos[,88])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(88,88,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```


#### Dejar bicicletas
Pregunta: `r names(datos[,89])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(89,89,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Cantidad niños
Pregunta: `r names(datos[,90])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(90,90,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

## 7. Entorno de las escuelas {.tabset .tabset-fade .tabset-pills}

<!-- `Interpretación. Respecto al entorno entre las escuelas, si se observan asociaciones respecto de Cuenca e Ibarra` -->

### Barrio de las escuelas {.tabset .tabset-fade}

De las siguientes afirmaciones sobre el barrio alrededor de la escuela, marque solo una opción de qué tan de acuerdo está con ellas.

#### Ayuda de vecinos
Pregunta: `r names(datos[,92])`

```{r}
plot<- graficos(92,92,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
# names(datos[,92])
```

<!-- `Para el caso de Cuenca, existe una asociación positiva con "Muy de acuerdo" en que los vecinos del barrio de la escuela siempre están dispuestos a ayudar`   -->

#### Cuidado de niños
Pregunta: `r names(datos[,93])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(93,93,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
# names(datos[,93])
```

<!-- `Para el caso de Cuenca, existe una asociación postiva con "Muy de acuerdo" en que los vecinos del barrio de la escuela cuidan de nuestros niños`  -->

#### Confianza
Pregunta: `r names(datos[,94])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(94,94,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
# names(datos[,94])

```

<!-- `Para el caso de Cuenca, existe una asociación postiva con "Algo de acuerdo" en que los vecinos del barrio de la escuela son de confianza, mientras que para el caso de Ibarra dicha asociacion es negativa.`  -->

#### Saludos
Pregunta: `r names(datos[,95])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(95,95,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Ambiente agradable
Pregunta: `r names(datos[,96])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(96,96,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Realidad en el entorno de la escuela {.tabset .tabset-fade}
Responda y marque la opción que más refleje la realidad de la zona alrededor de la escuela

#### Limpieza
Pregunta: `r names(datos[,98])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(98,98,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

#### Arboles
Pregunta: `r names(datos[,99])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(99,99,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

## 8. Percepción final {.tabset .tabset-fade .tabset-pills}
¿Qué tan de acuerdo está usted con las siguientes expresiones?

### Riesgos cardiovasculares
Pregunta: `r names(datos[,101])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(101,101,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Obesidad
Pregunta: `r names(datos[,102])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(102,102,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Contaminación ambiental
Pregunta: `r names(datos[,103])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(103,103,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Tráfico y congestión
Pregunta: `r names(datos[,104])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(104,104,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Aptitudes académicas
Pregunta: `r names(datos[,105])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(105,105,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

## 9. Información socio-económica {.tabset .tabset-fade .tabset-pills}

### Enfermedad respiratoria
Pregunta: `r names(datos[,106])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(106,106,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Condición de salud
Pregunta: `r names(datos[,108])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(108,108,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Condición de visión
Pregunta: `r names(datos[,109])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(109,109,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Promedio notas
Pregunta: `r names(datos[,110])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(110,110,139,265,c("Su promedio de notas son mayores a 8", "Su promedio de notas se encuentra entre 6 y 8", "Su promedio de notas se encuentra entre 4 y 6", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Nivel estudios encuestado
Pregunta: `r names(datos[,111])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(111,111,139,265,c("Sin estudios", "Primaria","Secundaria", "Formación personal", "Universitarios", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Acceso internet
Pregunta: `r names(datos[,112])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(112,112,139,265,c("Sí", "No", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Vehículo
Pregunta: `r names(datos[,113])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(113,113,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Licencias
Pregunta: `r names(datos[,114])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(114,114,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

### Ingreso
Pregunta: `r names(datos[,115])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(115,115,139,265,c("Ninguno","< 399", "400 - 799", "800 - 1199", "1200 - 1599", "1600 - 1999", "2000 - 2399","2400 - 2799", "2800 - 3199",  "> 3200", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

# B. Analisis por escuelas

```{r echo=FALSE , warning=FALSE}
#Graficos barras x ciudad
graficos<- function(colnumber.c,colnumbar.i,escuela.c, escuela.i, facetcolum.c, facetcolumn.i, levels, angle, ylim){

  datos.tmp.c<- datos[,c(colnumber.c, escuela.c,facetcolum.c)]
  names(datos.tmp.c)<- c("clase", "escuela", "ciudad")
datos.tmp.i<- datos.i[,c(colnumbar.i, escuela.i,facetcolumn.i)]
  names(datos.tmp.i)<- c("clase", "escuela","ciudad")

datos.tmp<- rbind(datos.tmp.c, datos.tmp.i)

datos.tmp$clase[is.na(datos.tmp$clase)]<-"No sabe/No contesta"

datos.tmp$clase<- factor(datos.tmp$clase, levels=levels,ordered=TRUE)

datos.tmp.2 <-datos.tmp %>% dplyr::group_by(ciudad,escuela,clase)%>%  
    na.omit() %>% dplyr::summarise(n = dplyr::n())%>%
  dplyr::mutate(Frecuencia = round(100*n / sum(n),2))

# print(sum(datos.tmp.2$Frecuencia))

p<- ggplot(datos.tmp.2, aes(x=clase, y=Frecuencia, fill=factor(escuela)))+ geom_bar(stat="identity",position="dodge")+ theme(axis.text.x = element_text(angle = angle)) +labs(x="", y="%") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(.~ciudad)

return(list(datos.tmp,p))
}

# mosaic.a<- function(plot){
# SD<- structable(clase ~ ciudad+escuela, data = plot[[1]])
# mosaic(SD, shade = TRUE,
#          labeling = labeling_values,#,labeling_residuals
#          labeling_args = list(abbreviate_labs = 9,
#                               gp_labels = gpar(fontsize = 8),
#                               varnames=c(FALSE,FALSE),
#                               rot_labels=c(90,0,0,0),
#                               just_labels = c("left", "right")))
# }

mosaic.a<- function(plot){
SD<- structable(clase ~ ciudad+escuela, data = plot[[1]])
mosaic(SD, shade = TRUE,
         labeling = labeling_values,#,labeling_residuals
       split_vertical = c(TRUE, FALSE, TRUE),
        # spacing = spacing_dimequal(c(2,2,2,2)),
       # split_vertical = c(FALSE, FALSE, FALSE, TRUE),
         labeling_args = list(abbreviate_labs = 9,
                              gp_labels = gpar(fontsize = 8),
                              varnames=c(FALSE,FALSE),
                              rot_labels=c(0,0,90,0),
                              just_labels = c("left", "right", "right", "right")))
}
```

## 1. Datos Encuestado {.tabset .tabset-fade .tabset-pills}

### Edad {.tabset .tabset-fade}

#### Encuestado

```{r echo=FALSE, warning=FALSE, message=FALSE}
# datos$"Datos encuestado/3.1. Edad"[datos$"Datos encuestado/3.1. Edad"== "-"]<- NA
edad.c<-data.frame(as.numeric(datos$"Datos encuestado/3.1. Edad"), datos$escuela, datos$ciudad)
names(edad.c)<- c("edad", "escuela", "ciudad")

edad.i<-data.frame(as.numeric(datos.i$"3.1. Edad"), datos.i$escuela, datos.i$ciudad)
names(edad.i)<- c("edad", "escuela", "ciudad")

edad<- rbind(edad.c, edad.i)
ggplotly(ggplot(edad)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="Densidad") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(.~ciudad))
```

#### Hijo/a o representado

```{r echo=FALSE, warning=FALSE, message=FALSE}
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "-"]<- NA
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "NC"]<- NA

edad.h.c<-data.frame(as.numeric(datos$"Datos encuestado/3.2. Edad de su hijo/a o representado"[!is.na(datos$"Datos encuestado/3.2. Edad de su hijo/a o representado")]), datos$escuela, datos$ciudad)
names(edad.h.c)<- c("edad", "escuela", "ciudad")
edad.h.c$edad[edad.h.c$edad == "1"]<- NA

edad.h.i<-data.frame(as.numeric(datos.i$"3.2. Edad de su hijo/a o representado"), datos.i$escuela, datos.i$ciudad)
names(edad.h.i)<- c("edad", "escuela", "ciudad")

edad.h<- rbind(edad.h.c, edad.h.i)
# table(edad.h$edad,edad.h$ciudad)
# ggplotly(ggplot(edad.h)+ geom_histogram(aes(x=edad, y=stat(count), fill=factor(ciudad)),binwidth=1)+ theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="Frecuencia") + scale_fill_manual(values=c("dodgerblue2","darkorange1"))+
#   guides(fill=guide_legend(title=""))+facet_grid(.~ciudad))

ggplotly(ggplot(edad.h)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="Densidad") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(.~ciudad))
```

### Parentezco  
Pregunta: `r names(datos[,8])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(8, 8,138,264, 139,265,c("Madre", "Padre", "Otro", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Genero niño/a  
Pregunta: `r names(datos[,10])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(10, 10,138,264,139,265,c("Niña", "Niño", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

## 2. Modo desplazamiento casa-escuela {.tabset .tabset-fade .tabset-pills}

### Desplazamiento 
Pregunta: `r names(datos[,14])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(14, 14,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### ¿Camina la última parte del trayecto?
Pregunta: `r names(datos[,16])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(16, 16,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### ¿Va solo/a a la escuela?
Pregunta: `r names(datos[,18])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(18, 18,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,19])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(19, 19,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,20])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(20, 20,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,21])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(21,21,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Abuelo
Pregunta: `r names(datos[,22])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(22,22,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si"))) 
mosaic.a(plot)
```


#### Otros niños/adolescentes
Pregunta: `r names(datos[,23])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(23,23,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,24])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(24,24,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,25])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(25,25,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```


## 3. Modo desplazamiento escuela-casa {.tabset .tabset-fade .tabset-pills}

### Desplazamiento
Pregunta: `r names(datos[,26])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(26,26,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### ¿Camina la primera parte del trayecto?
Pregunta: `r names(datos[,28])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(28,28,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### ¿Regresa solo/a?
Pregunta: `r names(datos[,30])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(30,30,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,31])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(31,31,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,32])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(32,32,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,33])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(33,33,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

####  Abuelo
Pregunta: `r names(datos[,34])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(34,34,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Otros niños/adolescentes
Pregunta: `r names(datos[,35])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(35,35,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,36])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(36,36,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,37])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(37,37,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

## 4. Percepción y razones {.tabset .tabset-fade .tabset-pills}

### Miedo a ir solo/a

Pregunta: `r names(datos[,38])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(38,38,138,264,139,265,c("Si tengo miedo", "No tengo miedo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Razones {.tabset .tabset-fade}

¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? ¿Qué tanta incidencia tienen los siguientes factores?

#### Distancia
Pregunta: `r names(datos[,40])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(40,40,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Seguridad Vial
Pregunta: `r names(datos[,41])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(41,41,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
# mosaic.a(plot)
```

#### Seguridad Personal
Pregunta: `r names(datos[,42])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(42,42,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Relaciones Sociales
Pregunta: `r names(datos[,43])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(43,43,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Costo
Pregunta: `r names(datos[,44])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(44,44,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

#### Salud
Pregunta: `r names(datos[,45])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(45,45,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

[8] "Desplazamiento general/11. ¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? (Puede marcar varias opciones)/Conveniencia (ej: horarios padres, paradas cercanas de transporte público)"

#### Conveniencia
Pregunta: `r names(datos[,46])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(46,46,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))
mosaic.a(plot)
```

## 5. Detalles del desplazamiento {.tabset .tabset-fade .tabset-pills}

### Tiempo de desplazamiento 
Pregunta: `r names(datos[,48])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(48,48,138,264,139,265,c("Menos de 5 min", "Entre 5 min y 15 min", "Entre 15 min y 30 min", "Entre 30 min y 60 min", "Más de 60 min", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```


### Distancia aceptable  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,49])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(49,49,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,50])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(50,50,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```


#### Con adultos
Pregunta: `r names(datos[,51])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(51,51,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Distancia aceptable en bicicleta  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(52,52,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(53,53,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,54])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(54,54,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Caminar a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,55])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(55,55,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,56])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(56,56,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,57])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(57,57,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Ir en bicileta a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,58])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(58,58,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,59])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(59,59,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,60])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(60,60,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

## 6. Preocupación en caminar y bicicleta {.tabset .tabset-fade .tabset-pills}

¿Qué tanto le preocuparían estas situaciones con respecto a que su hijo camine o vaya en bicicleta a la escuela?

### Situaciones Generales  {.tabset .tabset-fade}

#### Distancia
Pregunta: `r names(datos[,62])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(62,62,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,63])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(63,63,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```


#### Velocidad automóviles
Pregunta: `r names(datos[,64])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(64,64,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Tiempo
Pregunta: `r names(datos[,65])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(65,65,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Seguridad intersecciones
Pregunta: `r names(datos[,66])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(66,66,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Presencia de polícias
Pregunta: `r names(datos[,67])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(67,67,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,68])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(68,68,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Frio/calor
Pregunta: `r names(datos[,69])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(69,69,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Lluvia
Pregunta: `r names(datos[,70])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(70,70,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Peso mochila
Pregunta: `r names(datos[,71])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(71,71,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Sobre caminar  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,72])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(72,72,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Veredas mal estado
Pregunta: `r names(datos[,73])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(73,73,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,74])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(74,74,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,75])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(75,75,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Sobre biclicleta  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,76])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(76,76,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Ausencia de ciclovias
Pregunta: `r names(datos[,77])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(77,77,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Espacio para bicicleta
Pregunta: `r names(datos[,78])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(78,78,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,79])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(79,79,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,80])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(80,80,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Mejora de situaciones al caminar o bicicleta {.tabset .tabset-fade}

Si las siguientes situaciones mejoran ¿dejaría a su hijo/a ir caminando o en bicicleta a la escuela?

#### Distancia
Pregunta: `r names(datos[,82])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(82,82,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,83])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(83,83,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

#### Intersecciones
Pregunta: `r names(datos[,84])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(84,84,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,85])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(85,85,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Cantidad de personas
Pregunta: `r names(datos[,86])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(86,86,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

#### Veredas
Pregunta: `r names(datos[,87])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(87,87,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

#### Ciclovias
Pregunta: `r names(datos[,88])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(88,88,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```


#### Dejar bicicletas
Pregunta: `r names(datos[,89])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(89,89,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

#### Cantidad niños
Pregunta: `r names(datos[,90])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(90,90,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

## 7. Entorno de las escuelas {.tabset .tabset-fade .tabset-pills}

### Barrio de las escuelas {.tabset .tabset-fade}

De las siguientes afirmaciones sobre el barrio alrededor de la escuela, marque solo una opción de qué tan de acuerdo está con ellas

#### Ayuda de vecinos
Pregunta: `r names(datos[,92])`

```{r}
plot<- graficos(92,92,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Cuidado de niños
Pregunta: `r names(datos[,93])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(93,93,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Confianza
Pregunta: `r names(datos[,94])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(94,94,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Saludos
Pregunta: `r names(datos[,95])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(95,95,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

#### Ambiente agradable
Pregunta: `r names(datos[,96])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(96,96,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Realidad en el entorno de la escuela {.tabset .tabset-fade}
Responda y marque la opción que más refleje la realidad de la zona alrededor de la escuela

#### Limpieza
Pregunta: `r names(datos[,98])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(98,98,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

#### Arboles
Pregunta: `r names(datos[,99])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(99,99,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

## 8. Percepción final {.tabset .tabset-fade .tabset-pills}
¿Qué tan de acuerdo está usted con las siguientes expresiones?

### Riesgos cardiovasculares
Pregunta: `r names(datos[,101])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(101,101,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Obesidad
Pregunta: `r names(datos[,102])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(102,102,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Contaminación ambiental
Pregunta: `r names(datos[,103])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(103,103,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Tráfico y congestión
Pregunta: `r names(datos[,104])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(104,104,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Aptitudes académicas
Pregunta: `r names(datos[,105])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(105,105,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
# mosaic.a(plot)
```

## 9. Información socio-económica {.tabset .tabset-fade .tabset-pills}

### Enfermedad respiratoria
Pregunta: `r names(datos[,106])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(106,106,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Condición de salud
Pregunta: `r names(datos[,108])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(108,108,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Condición de visión
Pregunta: `r names(datos[,109])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(109,109,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Promedio notas
Pregunta: `r names(datos[,110])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(110,110,138,264,139,265,c("Su promedio de notas son mayores a 8", "Su promedio de notas se encuentra entre 6 y 8", "Su promedio de notas se encuentra entre 4 y 6", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Nivel estudios encuestado
Pregunta: `r names(datos[,111])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(111,111,138,264,139,265,c("Sin estudios", "Primaria","Secundaria", "Formación personal", "Universitarios", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Acceso internet
Pregunta: `r names(datos[,112])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(112,112,138,264,139,265,c("Sí", "No", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

### Vehículo
Pregunta: `r names(datos[,113])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(113,113,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```

### Licencias
Pregunta: `r names(datos[,114])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(114,114,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
 mosaic.a(plot)
```

### Ingreso
Pregunta: `r names(datos[,115])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(115,115,138,264,139,265,c("Ninguno","< 399", "400 - 799", "800 - 1199", "1200 - 1599", "1600 - 1999", "2000 - 2399","2400 - 2799", "2800 - 3199",  "> 3200", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])
mosaic.a(plot)
```




# C. Analisis por escuelas y género

```{r echo=FALSE , warning=FALSE}
#Graficos barras x ciudad x escuela x genero
graficos<- function(colnumber.c,colnumbar.i,escuela.c, escuela.i, facetcolum.c, facetcolumn.i, levels, angle, ylim){

  datos.tmp.c<- datos[,c(colnumber.c, 10,escuela.c,facetcolum.c)]
  names(datos.tmp.c)<- c("clase", "genero","escuela", "ciudad")
datos.tmp.i<- datos.i[,c(colnumbar.i, 10, escuela.i,facetcolumn.i)]
  names(datos.tmp.i)<- c("clase", "genero","escuela","ciudad")

datos.tmp<- rbind(datos.tmp.c, datos.tmp.i)

# datos.tmp$clase[is.na(datos.tmp$clase)]<-"No sabe/No contesta"
datos.tmp<-datos.tmp[datos.tmp$genero!= "No sabe/No contesta",]
datos.tmp$genero<-droplevels(datos.tmp)$genero

datos.tmp$clase<- factor(datos.tmp$clase, levels=levels,ordered=TRUE)

datos.tmp.2 <-datos.tmp %>% dplyr::group_by(genero,ciudad,escuela,clase)%>%  
    na.omit() %>% dplyr::summarise(n = dplyr::n())%>%
  dplyr::mutate(Frecuencia = round(100*n / sum(n),2))

# print(sum(datos.tmp.2$Frecuencia))

p<- ggplot(datos.tmp.2, aes(x=clase, y=Frecuencia, fill=factor(escuela)))+ geom_bar(stat="identity",position="dodge")+ theme(axis.text.x = element_text(angle = angle)) +labs(x="", y="%") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(genero~ciudad)

return(list(datos.tmp,p))
}

mosaic.a<- function(plot){
SD<- structable(clase ~ ciudad+genero, data = plot[[1]])
mosaic(SD, shade = TRUE,
         labeling = labeling_values,#,labeling_residuals
       split_vertical = c(TRUE, FALSE, TRUE),
        # spacing = spacing_dimequal(c(2,2,2,2)),
       # split_vertical = c(FALSE, FALSE, FALSE, TRUE),
         labeling_args = list(abbreviate_labs = 9,
                              gp_labels = gpar(fontsize = 8),
                              varnames=c(FALSE,FALSE),
                              rot_labels=c(0,0,90,0),
                              just_labels = c("left", "right", "right", "right")))
}

# mosaic(SD, split_vertical = c(TRUE, FALSE, TRUE), labeling_args = list(abbreviate_labs = c(Eye = 3)))
# 
# doubledecker()
# 
# vcd::doubledecker( clase ~ genero, SD)
# pairs(SD)



```

## 1. Datos Encuestado {.tabset .tabset-fade .tabset-pills}

### Edad {.tabset .tabset-fade}

#### Encuestado

```{r echo=FALSE, warning=FALSE, message=FALSE}
# datos$"Datos encuestado/3.1. Edad"[datos$"Datos encuestado/3.1. Edad"== "-"]<- NA
edad.c<-data.frame(as.numeric(datos$"Datos encuestado/3.1. Edad"), datos$"Datos encuestado/3.5. Su hijo es:",datos$escuela, datos$ciudad)
names(edad.c)<- c("edad", "genero", "escuela", "ciudad")

edad.i<-data.frame(as.numeric(datos.i$"3.1. Edad"), datos.i$"3.5. Su hijo es:", datos.i$escuela, datos.i$ciudad)
names(edad.i)<- c("edad", "genero","escuela", "ciudad")

edad<- rbind(edad.c, edad.i)

```

En los siguientes gráficos se omiten los 65 registros de No sabe/No contesta.
```{r echo=FALSE, warning=FALSE, message=FALSE}
table(edad$genero)

edad<-edad[edad$genero!= "No sabe/No contesta",]
edad$genero<-droplevels(edad)$genero

```


```{r echo=FALSE, warning=FALSE, message=FALSE}
ggplotly(ggplot(edad)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(genero~ciudad))%>% layout(legend = list(orientation = "l", x = 1.1))
```

#### Hijo/a o representado

```{r echo=FALSE, warning=FALSE, message=FALSE}
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "-"]<- NA
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "NC"]<- NA

edad.h.c<-data.frame(as.numeric(datos$"Datos encuestado/3.2. Edad de su hijo/a o representado"[!is.na(datos$"Datos encuestado/3.2. Edad de su hijo/a o representado")]), datos$"Datos encuestado/3.5. Su hijo es:",datos$escuela, datos$ciudad)
names(edad.h.c)<- c("edad","genero", "escuela", "ciudad")
edad.h.c$edad[edad.h.c$edad == "1"]<- NA

edad.h.i<-data.frame(as.numeric(datos.i$"3.2. Edad de su hijo/a o representado"),datos.i$"3.5. Su hijo es:", datos.i$escuela, datos.i$ciudad)
names(edad.h.i)<- c("edad", "genero","escuela", "ciudad")

edad.h<- rbind(edad.h.c, edad.h.i)

edad.h<-edad.h[edad.h$genero!= "No sabe/No contesta",]
edad.h$genero<-droplevels(edad.h)$genero

ggplotly(ggplot(edad.h)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(genero~ciudad)) %>% layout(legend = list(orientation = "l", x = 1.1))

```

### Parentezco  
Pregunta: `r names(datos[,8])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(8, 8,138,264, 139,265,c("Madre", "Padre", "Otro", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

<!-- ### Genero niño/a   -->
<!-- Pregunta: `r names(datos[,10])` -->

<!-- ```{r echo=FALSE, warning=FALSE} -->
<!-- plot<- graficos(10, 10,138,264,139,265,c("Niña", "Niño", "No sabe/No contesta"), 40, 100) -->
<!-- ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1)) -->
<!-- mosaic.a(plot) -->
<!-- ``` -->

## 2. Modo desplazamiento casa-escuela {.tabset .tabset-fade .tabset-pills}

### Desplazamiento 
Pregunta: `r names(datos[,14])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(14, 14,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Camina la última parte del trayecto?
Pregunta: `r names(datos[,16])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(16, 16,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Va solo/a a la escuela?
Pregunta: `r names(datos[,18])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(18, 18,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,19])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(19, 19,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,20])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(20, 20,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,21])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(21,21,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuelo
Pregunta: `r names(datos[,22])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(22,22,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si"))) %>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Otros niños/adolescentes
Pregunta: `r names(datos[,23])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(23,23,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,24])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(24,24,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,25])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(25,25,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


## 3. Modo desplazamiento escuela-casa {.tabset .tabset-fade .tabset-pills}

### Desplazamiento
Pregunta: `r names(datos[,26])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(26,26,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Camina la primera parte del trayecto?
Pregunta: `r names(datos[,28])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(28,28,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Regresa solo/a?
Pregunta: `r names(datos[,30])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(30,30,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,31])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(31,31,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,32])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(32,32,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,33])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(33,33,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

####  Abuelo
Pregunta: `r names(datos[,34])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(34,34,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros niños/adolescentes
Pregunta: `r names(datos[,35])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(35,35,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,36])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(36,36,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,37])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(37,37,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 4. Percepción y razones {.tabset .tabset-fade .tabset-pills}

### Miedo a ir solo/a

Pregunta: `r names(datos[,38])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(38,38,138,264,139,265,c("Si tengo miedo", "No tengo miedo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Razones {.tabset .tabset-fade}

¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? ¿Qué tanta incidencia tienen los siguientes factores?

#### Distancia
Pregunta: `r names(datos[,40])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(40,40,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

#### Seguridad Vial
Pregunta: `r names(datos[,41])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(41,41,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

#### Seguridad Personal
Pregunta: `r names(datos[,42])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(42,42,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Relaciones Sociales
Pregunta: `r names(datos[,43])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(43,43,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Costo
Pregunta: `r names(datos[,44])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(44,44,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Salud
Pregunta: `r names(datos[,45])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(45,45,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

[8] "Desplazamiento general/11. ¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? (Puede marcar varias opciones)/Conveniencia (ej: horarios padres, paradas cercanas de transporte público)"

#### Conveniencia
Pregunta: `r names(datos[,46])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(46,46,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 5. Detalles del desplazamiento {.tabset .tabset-fade .tabset-pills}

### Tiempo de desplazamiento 
Pregunta: `r names(datos[,48])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(48,48,138,264,139,265,c("Menos de 5 min", "Entre 5 min y 15 min", "Entre 15 min y 30 min", "Entre 30 min y 60 min", "Más de 60 min", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


### Distancia aceptable  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,49])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(49,49,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,50])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(50,50,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Con adultos
Pregunta: `r names(datos[,51])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(51,51,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Distancia aceptable en bicicleta  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(52,52,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(53,53,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,54])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(54,54,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Caminar a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,55])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(55,55,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,56])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(56,56,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,57])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(57,57,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Ir en bicileta a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,58])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(58,58,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,59])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(59,59,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,60])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(60,60,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 6. Preocupación en caminar y bicicleta {.tabset .tabset-fade .tabset-pills}

¿Qué tanto le preocuparían estas situaciones con respecto a que su hijo camine o vaya en bicicleta a la escuela?

### Situaciones Generales  {.tabset .tabset-fade}

#### Distancia
Pregunta: `r names(datos[,62])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(62,62,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,63])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(63,63,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Velocidad automóviles
Pregunta: `r names(datos[,64])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(64,64,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Tiempo
Pregunta: `r names(datos[,65])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(65,65,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Seguridad intersecciones
Pregunta: `r names(datos[,66])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(66,66,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Presencia de polícias
Pregunta: `r names(datos[,67])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(67,67,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,68])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(68,68,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Frio/calor
Pregunta: `r names(datos[,69])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(69,69,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Lluvia
Pregunta: `r names(datos[,70])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(70,70,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Peso mochila
Pregunta: `r names(datos[,71])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(71,71,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Sobre caminar  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,72])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(72,72,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Veredas mal estado
Pregunta: `r names(datos[,73])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(73,73,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,74])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(74,74,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,75])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(75,75,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Sobre biclicleta  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,76])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(76,76,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia de ciclovias
Pregunta: `r names(datos[,77])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(77,77,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Espacio para bicicleta
Pregunta: `r names(datos[,78])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(78,78,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,79])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(79,79,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,80])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(80,80,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Mejora de situaciones al caminar o bicicleta {.tabset .tabset-fade}

Si las siguientes situaciones mejoran ¿dejaría a su hijo/a ir caminando o en bicicleta a la escuela?

#### Distancia
Pregunta: `r names(datos[,82])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(82,82,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,83])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(83,83,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Intersecciones
Pregunta: `r names(datos[,84])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(84,84,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,85])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(85,85,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Cantidad de personas
Pregunta: `r names(datos[,86])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(86,86,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Veredas
Pregunta: `r names(datos[,87])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(87,87,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Ciclovias
Pregunta: `r names(datos[,88])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(88,88,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Dejar bicicletas
Pregunta: `r names(datos[,89])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(89,89,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Cantidad niños
Pregunta: `r names(datos[,90])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(90,90,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

## 7. Entorno de las escuelas {.tabset .tabset-fade .tabset-pills}

### Barrio de las escuelas {.tabset .tabset-fade}

De las siguientes afirmaciones sobre el barrio alrededor de la escuela, marque solo una opción de qué tan de acuerdo está con ellas

#### Ayuda de vecinos
Pregunta: `r names(datos[,92])`

```{r}
plot<- graficos(92,92,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Cuidado de niños
Pregunta: `r names(datos[,93])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(93,93,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Confianza
Pregunta: `r names(datos[,94])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(94,94,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Saludos
Pregunta: `r names(datos[,95])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(95,95,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ambiente agradable
Pregunta: `r names(datos[,96])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(96,96,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Realidad en el entorno de la escuela {.tabset .tabset-fade}
Responda y marque la opción que más refleje la realidad de la zona alrededor de la escuela

#### Limpieza
Pregunta: `r names(datos[,98])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(98,98,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Arboles
Pregunta: `r names(datos[,99])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(99,99,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 8. Percepción final {.tabset .tabset-fade .tabset-pills}
¿Qué tan de acuerdo está usted con las siguientes expresiones?

### Riesgos cardiovasculares
Pregunta: `r names(datos[,101])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(101,101,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Obesidad
Pregunta: `r names(datos[,102])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(102,102,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Contaminación ambiental
Pregunta: `r names(datos[,103])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(103,103,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Tráfico y congestión
Pregunta: `r names(datos[,104])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(104,104,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Aptitudes académicas
Pregunta: `r names(datos[,105])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(105,105,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

## 9. Información socio-económica {.tabset .tabset-fade .tabset-pills}

### Enfermedad respiratoria
Pregunta: `r names(datos[,106])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(106,106,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Condición de salud
Pregunta: `r names(datos[,108])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(108,108,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Condición de visión
Pregunta: `r names(datos[,109])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(109,109,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Promedio notas
Pregunta: `r names(datos[,110])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(110,110,138,264,139,265,c("Su promedio de notas son mayores a 8", "Su promedio de notas se encuentra entre 6 y 8", "Su promedio de notas se encuentra entre 4 y 6", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Nivel estudios encuestado
Pregunta: `r names(datos[,111])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(111,111,138,264,139,265,c("Sin estudios", "Primaria","Secundaria", "Formación personal", "Universitarios", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acceso internet
Pregunta: `r names(datos[,112])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(112,112,138,264,139,265,c("Sí", "No", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

### Vehículo
Pregunta: `r names(datos[,113])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(113,113,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Licencias
Pregunta: `r names(datos[,114])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(114,114,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

### Ingreso
Pregunta: `r names(datos[,115])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(115,115,138,264,139,265,c("Ninguno","< 399", "400 - 799", "800 - 1199", "1200 - 1599", "1600 - 1999", "2000 - 2399","2400 - 2799", "2800 - 3199",  "> 3200", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```



# D. Analisis Caminar y género

```{r echo=FALSE , warning=FALSE}
#Graficos barras x ciudad x escuela x genero
graficos<- function(colnumber.c,colnumbar.i,escuela.c, escuela.i, facetcolum.c, facetcolumn.i, levels, angle, ylim){

    datos.tmp.c<- datos[,c(14,colnumber.c, 10,escuela.c,facetcolum.c)]
  names(datos.tmp.c)<- c("modo","clase", "genero","escuela", "ciudad")
datos.tmp.i<- datos.i[,c(14,colnumbar.i, 10, escuela.i,facetcolumn.i)]
  names(datos.tmp.i)<- c("modo","clase", "genero","escuela","ciudad")

datos.tmp<- rbind(datos.tmp.c, datos.tmp.i)

datos.tmp<- datos.tmp[datos.tmp$modo=="Caminando",]

datos.tmp$clase[is.na(datos.tmp$clase)]<-"No sabe/No contesta"
datos.tmp<-datos.tmp[datos.tmp$genero!= "No sabe/No contesta",]
datos.tmp$genero<-droplevels(datos.tmp)$genero

datos.tmp$clase<- factor(datos.tmp$clase, levels=levels,ordered=TRUE)

datos.tmp.2 <-datos.tmp %>% dplyr::group_by(genero,ciudad,escuela,clase)%>%  
    na.omit() %>% dplyr::summarise(n = dplyr::n())%>%
  dplyr::mutate(Frecuencia = round(100*n / sum(n),2))

# print(sum(datos.tmp.2$Frecuencia))

p<- ggplot(datos.tmp.2, aes(x=clase, y=Frecuencia, fill=factor(escuela)))+ geom_bar(stat="identity",position="dodge")+ theme(axis.text.x = element_text(angle = angle)) +labs(x="", y="%") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(genero~ciudad)

return(list(datos.tmp,p))
}

mosaic.a<- function(plot){
SD<- structable(clase ~ ciudad+genero, data = plot[[1]])
mosaic(SD, shade = TRUE,
         labeling = labeling_values,#,labeling_residuals
       split_vertical = c(TRUE, FALSE, TRUE),
        # spacing = spacing_dimequal(c(2,2,2,2)),
       # split_vertical = c(FALSE, FALSE, FALSE, TRUE),
         labeling_args = list(abbreviate_labs = 9,
                              gp_labels = gpar(fontsize = 8),
                              varnames=c(FALSE,FALSE),
                              rot_labels=c(0,0,90,0),
                              just_labels = c("left", "right", "right", "right")))
}

# mosaic(SD, split_vertical = c(TRUE, FALSE, TRUE), labeling_args = list(abbreviate_labs = c(Eye = 3)))
# 
# doubledecker()
# 
# vcd::doubledecker( clase ~ genero, SD)
# pairs(SD)



```

## 1. Datos Encuestado {.tabset .tabset-fade .tabset-pills}

### Edad {.tabset .tabset-fade}

#### Encuestado

```{r echo=FALSE, warning=FALSE, message=FALSE}
# datos$"Datos encuestado/3.1. Edad"[datos$"Datos encuestado/3.1. Edad"== "-"]<- NA
datos.c.c<- datos[datos$`Desplazamiento general/Desplazamiento casa-escuela/4. ¿Cómo va su hijo/a la escuela? (Marque solo el principal modo de desplazamiento)`=="Caminando",]

datos.i.c<- datos.i[datos.i$`4. ¿Cómo va su hijo/a la escuela? (Marque solo el principal modo de desplazamiento)`=="Caminando",]

edad.c<-data.frame(as.numeric(datos.c.c$"Datos encuestado/3.1. Edad"), datos.c.c$"Datos encuestado/3.5. Su hijo es:",datos.c.c$escuela, datos.c.c$ciudad)
names(edad.c)<- c("edad", "genero", "escuela", "ciudad")

edad.i<-data.frame(as.numeric(datos.i.c$"3.1. Edad"), datos.i.c$"3.5. Su hijo es:", datos.i.c$escuela, datos.i.c$ciudad)
names(edad.i)<- c("edad", "genero","escuela", "ciudad")

edad<- rbind(edad.c, edad.i)

edad<-edad[edad$genero!= "No sabe/No contesta",]
edad$genero<-droplevels(edad)$genero


ggplotly(ggplot(edad)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(genero~ciudad))%>% layout(legend = list(orientation = "l", x = 1.1))
```

#### Hijo/a o representado

```{r echo=FALSE, warning=FALSE, message=FALSE}
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "-"]<- NA
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "NC"]<- NA


edad.h.c<-data.frame(as.numeric(datos.c.c$"Datos encuestado/3.2. Edad de su hijo/a o representado"[!is.na(datos.c.c$"Datos encuestado/3.2. Edad de su hijo/a o representado")]), datos.c.c$"Datos encuestado/3.5. Su hijo es:",datos.c.c$escuela, datos.c.c$ciudad)
names(edad.h.c)<- c("edad","genero", "escuela", "ciudad")
edad.h.c$edad[edad.h.c$edad == "1"]<- NA

edad.h.i<-data.frame(as.numeric(datos.i.c$"3.2. Edad de su hijo/a o representado"),datos.i.c$"3.5. Su hijo es:", datos.i.c$escuela, datos.i.c$ciudad)
names(edad.h.i)<- c("edad", "genero","escuela", "ciudad")

edad.h<- rbind(edad.h.c, edad.h.i)

edad.h<-edad.h[edad.h$genero!= "No sabe/No contesta",]
edad.h$genero<-droplevels(edad.h)$genero

ggplotly(ggplot(edad.h)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(genero~ciudad)) %>% layout(legend = list(orientation = "l", x = 1.1))

```

### Parentezco  
Pregunta: `r names(datos[,8])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(8, 8,138,264, 139,265,c("Madre", "Padre", "Otro", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

<!-- ### Genero niño/a   -->
<!-- Pregunta: `r names(datos[,10])` -->

<!-- ```{r echo=FALSE, warning=FALSE} -->
<!-- plot<- graficos(10, 10,138,264,139,265,c("Niña", "Niño", "No sabe/No contesta"), 40, 100) -->
<!-- ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1)) -->
<!-- mosaic.a(plot) -->
<!-- ``` -->

## 2. Modo desplazamiento casa-escuela {.tabset .tabset-fade .tabset-pills}

### Desplazamiento 
Pregunta: `r names(datos[,14])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(14, 14,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
# ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

<!-- ### ¿Camina la última parte del trayecto? -->
<!-- Pregunta: `r names(datos[,16])` -->

<!-- ```{r echo=FALSE, warning=FALSE} -->
<!-- plot<- graficos(16, 16,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100) -->
<!-- ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1)) -->
<!-- mosaic.a(plot) -->
<!-- ``` -->

### ¿Va solo/a a la escuela?
Pregunta: `r names(datos[,18])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(18, 18,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,19])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(19, 19,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,20])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(20, 20,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,21])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(21,21,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuelo
Pregunta: `r names(datos[,22])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(22,22,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si"))) %>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Otros niños/adolescentes
Pregunta: `r names(datos[,23])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(23,23,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,24])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(24,24,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,25])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(25,25,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


## 3. Modo desplazamiento escuela-casa {.tabset .tabset-fade .tabset-pills}

### Desplazamiento
Pregunta: `r names(datos[,26])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(26,26,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Camina la primera parte del trayecto?
Pregunta: `r names(datos[,28])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(28,28,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Regresa solo/a?
Pregunta: `r names(datos[,30])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(30,30,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,31])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(31,31,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,32])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(32,32,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,33])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(33,33,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

####  Abuelo
Pregunta: `r names(datos[,34])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(34,34,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros niños/adolescentes
Pregunta: `r names(datos[,35])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(35,35,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,36])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(36,36,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,37])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(37,37,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 4. Percepción y razones {.tabset .tabset-fade .tabset-pills}

### Miedo a ir solo/a

Pregunta: `r names(datos[,38])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(38,38,138,264,139,265,c("Si tengo miedo", "No tengo miedo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Razones {.tabset .tabset-fade}

¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? ¿Qué tanta incidencia tienen los siguientes factores?

#### Distancia
Pregunta: `r names(datos[,40])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(40,40,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

#### Seguridad Vial
Pregunta: `r names(datos[,41])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(41,41,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

#### Seguridad Personal
Pregunta: `r names(datos[,42])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(42,42,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Relaciones Sociales
Pregunta: `r names(datos[,43])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(43,43,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Costo
Pregunta: `r names(datos[,44])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(44,44,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Salud
Pregunta: `r names(datos[,45])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(45,45,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

[8] "Desplazamiento general/11. ¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? (Puede marcar varias opciones)/Conveniencia (ej: horarios padres, paradas cercanas de transporte público)"

#### Conveniencia
Pregunta: `r names(datos[,46])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(46,46,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 5. Detalles del desplazamiento {.tabset .tabset-fade .tabset-pills}

### Tiempo de desplazamiento 
Pregunta: `r names(datos[,48])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(48,48,138,264,139,265,c("Menos de 5 min", "Entre 5 min y 15 min", "Entre 15 min y 30 min", "Entre 30 min y 60 min", "Más de 60 min", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


### Distancia aceptable  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,49])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(49,49,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,50])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(50,50,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Con adultos
Pregunta: `r names(datos[,51])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(51,51,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Distancia aceptable en bicicleta  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(52,52,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(53,53,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,54])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(54,54,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Caminar a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,55])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(55,55,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,56])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(56,56,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,57])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(57,57,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Ir en bicileta a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,58])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(58,58,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,59])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(59,59,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,60])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(60,60,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 6. Preocupación en caminar y bicicleta {.tabset .tabset-fade .tabset-pills}

¿Qué tanto le preocuparían estas situaciones con respecto a que su hijo camine o vaya en bicicleta a la escuela?

### Situaciones Generales  {.tabset .tabset-fade}

#### Distancia
Pregunta: `r names(datos[,62])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(62,62,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,63])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(63,63,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Velocidad automóviles
Pregunta: `r names(datos[,64])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(64,64,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Tiempo
Pregunta: `r names(datos[,65])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(65,65,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Seguridad intersecciones
Pregunta: `r names(datos[,66])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(66,66,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Presencia de polícias
Pregunta: `r names(datos[,67])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(67,67,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,68])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(68,68,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Frio/calor
Pregunta: `r names(datos[,69])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(69,69,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Lluvia
Pregunta: `r names(datos[,70])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(70,70,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Peso mochila
Pregunta: `r names(datos[,71])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(71,71,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Sobre caminar  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,72])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(72,72,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Veredas mal estado
Pregunta: `r names(datos[,73])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(73,73,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,74])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(74,74,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,75])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(75,75,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Sobre biclicleta  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,76])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(76,76,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia de ciclovias
Pregunta: `r names(datos[,77])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(77,77,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Espacio para bicicleta
Pregunta: `r names(datos[,78])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(78,78,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,79])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(79,79,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,80])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(80,80,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Mejora de situaciones al caminar o bicicleta {.tabset .tabset-fade}

Si las siguientes situaciones mejoran ¿dejaría a su hijo/a ir caminando o en bicicleta a la escuela?

#### Distancia
Pregunta: `r names(datos[,82])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(82,82,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,83])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(83,83,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Intersecciones
Pregunta: `r names(datos[,84])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(84,84,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,85])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(85,85,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Cantidad de personas
Pregunta: `r names(datos[,86])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(86,86,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Veredas
Pregunta: `r names(datos[,87])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(87,87,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Ciclovias
Pregunta: `r names(datos[,88])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(88,88,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Dejar bicicletas
Pregunta: `r names(datos[,89])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(89,89,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Cantidad niños
Pregunta: `r names(datos[,90])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(90,90,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

## 7. Entorno de las escuelas {.tabset .tabset-fade .tabset-pills}

### Barrio de las escuelas {.tabset .tabset-fade}

De las siguientes afirmaciones sobre el barrio alrededor de la escuela, marque solo una opción de qué tan de acuerdo está con ellas

#### Ayuda de vecinos
Pregunta: `r names(datos[,92])`

```{r}
plot<- graficos(92,92,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Cuidado de niños
Pregunta: `r names(datos[,93])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(93,93,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Confianza
Pregunta: `r names(datos[,94])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(94,94,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Saludos
Pregunta: `r names(datos[,95])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(95,95,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ambiente agradable
Pregunta: `r names(datos[,96])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(96,96,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Realidad en el entorno de la escuela {.tabset .tabset-fade}
Responda y marque la opción que más refleje la realidad de la zona alrededor de la escuela

#### Limpieza
Pregunta: `r names(datos[,98])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(98,98,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Arboles
Pregunta: `r names(datos[,99])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(99,99,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 8. Percepción final {.tabset .tabset-fade .tabset-pills}
¿Qué tan de acuerdo está usted con las siguientes expresiones?

### Riesgos cardiovasculares
Pregunta: `r names(datos[,101])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(101,101,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Obesidad
Pregunta: `r names(datos[,102])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(102,102,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Contaminación ambiental
Pregunta: `r names(datos[,103])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(103,103,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Tráfico y congestión
Pregunta: `r names(datos[,104])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(104,104,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Aptitudes académicas
Pregunta: `r names(datos[,105])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(105,105,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

## 9. Información socio-económica {.tabset .tabset-fade .tabset-pills}

### Enfermedad respiratoria
Pregunta: `r names(datos[,106])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(106,106,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Condición de salud
Pregunta: `r names(datos[,108])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(108,108,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Condición de visión
Pregunta: `r names(datos[,109])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(109,109,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Promedio notas
Pregunta: `r names(datos[,110])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(110,110,138,264,139,265,c("Su promedio de notas son mayores a 8", "Su promedio de notas se encuentra entre 6 y 8", "Su promedio de notas se encuentra entre 4 y 6", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Nivel estudios encuestado
Pregunta: `r names(datos[,111])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(111,111,138,264,139,265,c("Sin estudios", "Primaria","Secundaria", "Formación personal", "Universitarios", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acceso internet
Pregunta: `r names(datos[,112])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(112,112,138,264,139,265,c("Sí", "No", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

### Vehículo
Pregunta: `r names(datos[,113])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(113,113,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Licencias
Pregunta: `r names(datos[,114])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(114,114,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

### Ingreso
Pregunta: `r names(datos[,115])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(115,115,138,264,139,265,c("Ninguno","< 399", "400 - 799", "800 - 1199", "1200 - 1599", "1600 - 1999", "2000 - 2399","2400 - 2799", "2800 - 3199",  "> 3200", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```



# E. Analisis Caminar e ingreso

```{r echo=FALSE , warning=FALSE}
#Graficos barras x ciudad x escuela x genero
graficos<- function(colnumber.c,colnumbar.i,escuela.c, escuela.i, facetcolum.c, facetcolumn.i, levels, angle, ylim){

    datos.tmp.c<- datos[,c(14,colnumber.c, 10,escuela.c,facetcolum.c)]
  names(datos.tmp.c)<- c("modo","clase", "ingreso","escuela", "ciudad")
datos.tmp.i<- datos.i[,c(14,colnumbar.i, 10, escuela.i,facetcolumn.i)]
  names(datos.tmp.i)<- c("modo","clase", "ingreso","escuela","ciudad")

datos.tmp<- rbind(datos.tmp.c, datos.tmp.i)

datos.tmp<- datos.tmp[datos.tmp$modo=="Caminando",]

datos.tmp$clase[is.na(datos.tmp$clase)]<-"No sabe/No contesta"
datos.tmp<-datos.tmp[datos.tmp$ingreso!= "No sabe/No contesta",]
# datos.tmp$ingreso<-droplevels(datos.tmp)$ingreso

datos.tmp$clase<- factor(datos.tmp$clase, levels=levels,ordered=TRUE)

datos.tmp.2 <-datos.tmp %>% dplyr::group_by(ingreso,ciudad,escuela,clase)%>%  
    na.omit() %>% dplyr::summarise(n = dplyr::n())%>%
  dplyr::mutate(Frecuencia = round(100*n / sum(n),2))

# print(sum(datos.tmp.2$Frecuencia))

p<- ggplot(datos.tmp.2, aes(x=clase, y=Frecuencia, fill=factor(escuela)))+ geom_bar(stat="identity",position="dodge")+ theme(axis.text.x = element_text(angle = angle)) +labs(x="", y="%") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(ingreso~ciudad)

return(list(datos.tmp,p))
}

mosaic.a<- function(plot){
SD<- structable(clase ~ ciudad+ingreso, data = plot[[1]])
mosaic(SD, shade = TRUE,
         labeling = labeling_values,#,labeling_residuals
       split_vertical = c(TRUE, FALSE, TRUE),
        # spacing = spacing_dimequal(c(2,2,2,2)),
       # split_vertical = c(FALSE, FALSE, FALSE, TRUE),
         labeling_args = list(abbreviate_labs = 9,
                              gp_labels = gpar(fontsize = 8),
                              varnames=c(FALSE,FALSE),
                              rot_labels=c(0,0,90,0),
                              just_labels = c("left", "right", "right", "right")))
}

# mosaic(SD, split_vertical = c(TRUE, FALSE, TRUE), labeling_args = list(abbreviate_labs = c(Eye = 3)))
# 
# doubledecker()
# 
# vcd::doubledecker( clase ~ genero, SD)
# pairs(SD)



```

## 1. Datos Encuestado {.tabset .tabset-fade .tabset-pills}

### Edad {.tabset .tabset-fade}

#### Encuestado

```{r echo=FALSE, warning=FALSE, message=FALSE}
# datos$"Datos encuestado/3.1. Edad"[datos$"Datos encuestado/3.1. Edad"== "-"]<- NA
datos.c.c<- datos[datos$`Desplazamiento general/Desplazamiento casa-escuela/4. ¿Cómo va su hijo/a la escuela? (Marque solo el principal modo de desplazamiento)`=="Caminando",]

datos.i.c<- datos.i[datos.i$`4. ¿Cómo va su hijo/a la escuela? (Marque solo el principal modo de desplazamiento)`=="Caminando",]


edad.c<-data.frame(as.numeric(datos.c.c$"Datos encuestado/3.1. Edad"), datos.c.c$"Información general del hogar/37. ¿Cuál es el ingreso aproximado de la unidad familiar (dólares)?" ,datos.c.c$escuela, datos.c.c$ciudad)
names(edad.c)<- c("edad", "ingreso", "escuela", "ciudad")

edad.i<-data.frame(as.numeric(datos.i.c$"3.1. Edad"), datos.i.c$"¿Cuál es el ingreso aproximado de la unidad familiar (dólares)?", datos.i.c$escuela, datos.i.c$ciudad)
names(edad.i)<- c("edad", "ingreso","escuela", "ciudad")

edad<- rbind(edad.c, edad.i)

edad<-edad[edad$ingreso!= "No sabe/No contesta",]
edad$ingreso<-droplevels(edad)$ingreso

edad$ingreso<-droplevels(edad)$ingreso

ggplotly(ggplot(edad)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(ingreso~ciudad))%>% layout(legend = list(orientation = "l", x = 1.1))
```

#### Hijo/a o representado

```{r echo=FALSE, warning=FALSE, message=FALSE}
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "-"]<- NA
datos$"3.2. Edad de su hijo/a o representado"[datos$"Datos encuestado/3.2. Edad de su hijo/a o representado" == "NC"]<- NA


edad.h.c<-data.frame(as.numeric(datos.c.c$"Datos encuestado/3.2. Edad de su hijo/a o representado"[!is.na(datos.c.c$"Datos encuestado/3.2. Edad de su hijo/a o representado")]), datos.c.c$"Datos encuestado/3.5. Su hijo es:",datos.c.c$escuela, datos.c.c$ciudad)
names(edad.h.c)<- c("edad","genero", "escuela", "ciudad")
edad.h.c$edad[edad.h.c$edad == "1"]<- NA

edad.h.i<-data.frame(as.numeric(datos.i.c$"3.2. Edad de su hijo/a o representado"),datos.i.c$"3.5. Su hijo es:", datos.i.c$escuela, datos.i.c$ciudad)
names(edad.h.i)<- c("edad", "genero","escuela", "ciudad")

edad.h<- rbind(edad.h.c, edad.h.i)

edad.h<-edad.h[edad.h$genero!= "No sabe/No contesta",]
edad.h$genero<-droplevels(edad.h)$genero

ggplotly(ggplot(edad.h)+ geom_density(aes(x=edad, y=stat(count), fill=factor(escuela)),position = "identity",alpha = 0.5) + theme(axis.text.x = element_text(angle = 0)) +labs(x="", y="") + scale_fill_manual(values=c("dodgerblue4","dodgerblue2", "lightsteelblue1","darkorange4","darkorange2","peachpuff"))+
  guides(fill=guide_legend(title=""))+facet_grid(genero~ciudad)) %>% layout(legend = list(orientation = "l", x = 1.1))

```

### Parentezco  
Pregunta: `r names(datos[,8])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(8, 8,115,264, 139,265,c("Madre", "Padre", "Otro", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

<!-- ### Genero niño/a   -->
<!-- Pregunta: `r names(datos[,10])` -->

<!-- ```{r echo=FALSE, warning=FALSE} -->
<!-- plot<- graficos(10, 10,138,264,139,265,c("Niña", "Niño", "No sabe/No contesta"), 40, 100) -->
<!-- ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1)) -->
<!-- mosaic.a(plot) -->
<!-- ``` -->

## 2. Modo desplazamiento casa-escuela {.tabset .tabset-fade .tabset-pills}

### Desplazamiento 
Pregunta: `r names(datos[,14])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(14, 14,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
# ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

<!-- ### ¿Camina la última parte del trayecto? -->
<!-- Pregunta: `r names(datos[,16])` -->

<!-- ```{r echo=FALSE, warning=FALSE} -->
<!-- plot<- graficos(16, 16,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100) -->
<!-- ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1)) -->
<!-- mosaic.a(plot) -->
<!-- ``` -->

### ¿Va solo/a a la escuela?
Pregunta: `r names(datos[,18])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(18, 18,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,19])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(19, 19,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,20])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(20, 20,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,21])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(21,21,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuelo
Pregunta: `r names(datos[,22])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(22,22,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si"))) %>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Otros niños/adolescentes
Pregunta: `r names(datos[,23])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(23,23,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,24])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(24,24,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,25])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(25,25,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


## 3. Modo desplazamiento escuela-casa {.tabset .tabset-fade .tabset-pills}

### Desplazamiento
Pregunta: `r names(datos[,26])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(26,26,138,264,139,265,c("Caminando", "Bicicleta", "Automóvil", "Moto", "Bus Escolar", "Buseta Escolar", "Bus Público", "Metro/Tren/Tranvía ", "Otro","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Camina la primera parte del trayecto?
Pregunta: `r names(datos[,28])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(28,28,138,264,139,265,c("Si camina", "No camina","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### ¿Regresa solo/a?
Pregunta: `r names(datos[,30])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(30,30,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acompañado/a {.tabset .tabset-fade}

#### Madre
Pregunta: `r names(datos[,31])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(31,31,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Padre
Pregunta: `r names(datos[,32])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(32,32,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Abuela
Pregunta: `r names(datos[,33])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(33,33,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

####  Abuelo
Pregunta: `r names(datos[,34])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(34,34,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros niños/adolescentes
Pregunta: `r names(datos[,35])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(35,35,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Otros adultos o persona que supervisa
Pregunta: `r names(datos[,36])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(36,36,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### No sabe/No contesta
Pregunta: `r names(datos[,37])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(37,37,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 4. Percepción y razones {.tabset .tabset-fade .tabset-pills}

### Miedo a ir solo/a

Pregunta: `r names(datos[,38])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(38,38,138,264,139,265,c("Si tengo miedo", "No tengo miedo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Razones {.tabset .tabset-fade}

¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? ¿Qué tanta incidencia tienen los siguientes factores?

#### Distancia
Pregunta: `r names(datos[,40])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(40,40,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

#### Seguridad Vial
Pregunta: `r names(datos[,41])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(41,41,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

#### Seguridad Personal
Pregunta: `r names(datos[,42])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(42,42,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Relaciones Sociales
Pregunta: `r names(datos[,43])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(43,43,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Costo
Pregunta: `r names(datos[,44])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(44,44,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Salud
Pregunta: `r names(datos[,45])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(45,45,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

[8] "Desplazamiento general/11. ¿Cuáles son las principales razones por las que su hijo se va/vuelve de la escuela en el modo indicado? (Puede marcar varias opciones)/Conveniencia (ej: horarios padres, paradas cercanas de transporte público)"

#### Conveniencia
Pregunta: `r names(datos[,46])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(46,46,138,264,139,265,c("0", "1"), 40, 100)
ggplotly(plot[[2]]+ scale_x_discrete(labels=c("No", "Si")))%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 5. Detalles del desplazamiento {.tabset .tabset-fade .tabset-pills}

### Tiempo de desplazamiento 
Pregunta: `r names(datos[,48])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(48,48,138,264,139,265,c("Menos de 5 min", "Entre 5 min y 15 min", "Entre 15 min y 30 min", "Entre 30 min y 60 min", "Más de 60 min", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


### Distancia aceptable  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,49])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(49,49,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,50])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(50,50,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Con adultos
Pregunta: `r names(datos[,51])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(51,51,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Distancia aceptable en bicicleta  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(52,52,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,52])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(53,53,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,54])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(54,54,138,264,139,265,c("Ninguna", "Menos de 5 cuadras (menos de 0.5 km)", "Entre 5 y 15 cuadras (entre 0.5 y 1.5 km)", "Entre 15 y 30 cuadras (entre 1.5 y 3 km)", "Entre 30 y 60 cuadras (entre 3 y 6 km)", "Más de 60 cuadras (mayor a 6 km)","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Caminar a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,55])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(55,55,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,56])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(56,56,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,57])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(57,57,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Ir en bicileta a la escuela  {.tabset .tabset-fade}

#### Solo/a
Pregunta: `r names(datos[,58])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(58,58,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con menores
Pregunta: `r names(datos[,59])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(59,59,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Con adultos
Pregunta: `r names(datos[,60])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(60,60,138,264,139,265,c(names(table(datos[,55]))[2], "8 - 9 años","10 - 11 años","12 - 13 años", "14 - 15 años", "16 - 17 años" , names(table(datos[,55]))[1],"No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 6. Preocupación en caminar y bicicleta {.tabset .tabset-fade .tabset-pills}

¿Qué tanto le preocuparían estas situaciones con respecto a que su hijo camine o vaya en bicicleta a la escuela?

### Situaciones Generales  {.tabset .tabset-fade}

#### Distancia
Pregunta: `r names(datos[,62])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(62,62,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,63])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(63,63,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Velocidad automóviles
Pregunta: `r names(datos[,64])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(64,64,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Tiempo
Pregunta: `r names(datos[,65])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(65,65,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Seguridad intersecciones
Pregunta: `r names(datos[,66])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(66,66,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Presencia de polícias
Pregunta: `r names(datos[,67])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(67,67,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,68])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(68,68,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Frio/calor
Pregunta: `r names(datos[,69])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(69,69,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Lluvia
Pregunta: `r names(datos[,70])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(70,70,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Peso mochila
Pregunta: `r names(datos[,71])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(71,71,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Sobre caminar  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,72])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(72,72,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Veredas mal estado
Pregunta: `r names(datos[,73])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(73,73,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,74])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(74,74,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,75])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(75,75,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Sobre biclicleta  {.tabset .tabset-fade}

#### Ausencia adultos
Pregunta: `r names(datos[,76])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(76,76,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia de ciclovias
Pregunta: `r names(datos[,77])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(77,77,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Espacio para bicicleta
Pregunta: `r names(datos[,78])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(78,78,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ausencia niños
Pregunta: `r names(datos[,79])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(79,79,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Aburrimiento
Pregunta: `r names(datos[,80])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(80,80,138,264,139,265,c("Mucho", "Regular", "Poco", "Nada","No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Mejora de situaciones al caminar o bicicleta {.tabset .tabset-fade}

Si las siguientes situaciones mejoran ¿dejaría a su hijo/a ir caminando o en bicicleta a la escuela?

#### Distancia
Pregunta: `r names(datos[,82])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(82,82,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Tráfico
Pregunta: `r names(datos[,83])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(83,83,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Intersecciones
Pregunta: `r names(datos[,84])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(84,84,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Violencia
Pregunta: `r names(datos[,85])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(85,85,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Cantidad de personas
Pregunta: `r names(datos[,86])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(86,86,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Veredas
Pregunta: `r names(datos[,87])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(87,87,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Ciclovias
Pregunta: `r names(datos[,88])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(88,88,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


#### Dejar bicicletas
Pregunta: `r names(datos[,89])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(89,89,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Cantidad niños
Pregunta: `r names(datos[,90])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(90,90,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

## 7. Entorno de las escuelas {.tabset .tabset-fade .tabset-pills}

### Barrio de las escuelas {.tabset .tabset-fade}

De las siguientes afirmaciones sobre el barrio alrededor de la escuela, marque solo una opción de qué tan de acuerdo está con ellas

#### Ayuda de vecinos
Pregunta: `r names(datos[,92])`

```{r}
plot<- graficos(92,92,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Cuidado de niños
Pregunta: `r names(datos[,93])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(93,93,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Confianza
Pregunta: `r names(datos[,94])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(94,94,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Saludos
Pregunta: `r names(datos[,95])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(95,95,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

#### Ambiente agradable
Pregunta: `r names(datos[,96])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(96,96,138,264,139,265,c("No conozco el barrio a los vecinos", "Muy en desacuerdo","Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Realidad en el entorno de la escuela {.tabset .tabset-fade}
Responda y marque la opción que más refleje la realidad de la zona alrededor de la escuela

#### Limpieza
Pregunta: `r names(datos[,98])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(98,98,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

#### Arboles
Pregunta: `r names(datos[,99])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(99,99,138,264,139,265,c("Ninguno", "Casi nada", "Pocos",  "Muchos", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

## 8. Percepción final {.tabset .tabset-fade .tabset-pills}
¿Qué tan de acuerdo está usted con las siguientes expresiones?

### Riesgos cardiovasculares
Pregunta: `r names(datos[,101])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(101,101,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Obesidad
Pregunta: `r names(datos[,102])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(102,102,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Contaminación ambiental
Pregunta: `r names(datos[,103])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(103,103,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Tráfico y congestión
Pregunta: `r names(datos[,104])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(104,104,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Aptitudes académicas
Pregunta: `r names(datos[,105])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(105,105,138,264,139,265,c("Muy en desacuerdo", "Algo en desacuerdo", "Algo de acuerdo", "Muy de acuerdo", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
# mosaic.a(plot)
```

## 9. Información socio-económica {.tabset .tabset-fade .tabset-pills}

### Enfermedad respiratoria
Pregunta: `r names(datos[,106])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(106,106,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Condición de salud
Pregunta: `r names(datos[,108])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(108,108,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Condición de visión
Pregunta: `r names(datos[,109])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(109,109,138,264,139,265,c("Sí", "No", "No sabe/No contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Promedio notas
Pregunta: `r names(datos[,110])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(110,110,138,264,139,265,c("Su promedio de notas son mayores a 8", "Su promedio de notas se encuentra entre 6 y 8", "Su promedio de notas se encuentra entre 4 y 6", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Nivel estudios encuestado
Pregunta: `r names(datos[,111])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(111,111,138,264,139,265,c("Sin estudios", "Primaria","Secundaria", "Formación personal", "Universitarios", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Acceso internet
Pregunta: `r names(datos[,112])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(112,112,138,264,139,265,c("Sí", "No", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

### Vehículo
Pregunta: `r names(datos[,113])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(113,113,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```

### Licencias
Pregunta: `r names(datos[,114])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(114,114,138,264,139,265,c("Ninguno", "Uno", "Dos", "Más de dos", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
 mosaic.a(plot)
```

### Ingreso
Pregunta: `r names(datos[,115])`

```{r echo=FALSE, warning=FALSE}
plot<- graficos(115,115,138,264,139,265,c("Ninguno","< 399", "400 - 799", "800 - 1199", "1200 - 1599", "1600 - 1999", "2000 - 2399","2400 - 2799", "2800 - 3199",  "> 3200", "No sabe/no contesta"), 40, 100)
ggplotly(plot[[2]])%>% layout(legend = list(orientation = "l", x = 1.1))
mosaic.a(plot)
```


